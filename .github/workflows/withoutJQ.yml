name: SSH Commands on ContainerPorts

on:
  push:
    branches:
      - main

jobs:
  ssh-on-container-ports:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Extract and SSH on ContainerPorts
      run: |
        # Read containerPort values without jq
        containerPorts=($(grep -A2 'containerPort' pod.yaml | grep -oP '(?<=containerPort: )\d+'))

        # Loop over each containerPort
        for containerPort in "${containerPorts[@]}"; do
          # Print the current containerPort
          echo "Container Port: $containerPort"

          # SSH command using the current containerPort
          # ssh user@host "your_command_using_$containerPort"
        done
